diff -b -u -r curl-7.21.1-orig/lib/Makefile.vc8 curl-7.21.1/lib/Makefile.vc8
--- curl-7.21.1-orig/lib/Makefile.vc8	2010-08-11 17:36:29.000000000 -0400
+++ curl-7.21.1/lib/Makefile.vc8	2010-11-19 16:33:25.741750000 -0500
@@ -92,7 +92,7 @@
 CCDEBUG    = cl.exe /Od /Gm /Zi /D_DEBUG /RTC1
 CFLAGSSSL  = /DUSE_SSLEAY /I "$(OPENSSL_PATH)/inc32" /I "$(OPENSSL_PATH)/inc32/openssl"
 CFLAGSZLIB = /DHAVE_ZLIB_H /DHAVE_ZLIB /DHAVE_LIBZ /I "$(ZLIB_PATH)"
-CFLAGS     = /I. /I../include /nologo /W3 /EHsc /DWIN32 /FD /c /DBUILDING_LIBCURL
+CFLAGS     = /I. /I../include /nologo /W3 /EHsc /DWIN32 /FD /c /DBUILDING_LIBCURL /DUSE_ARES
 CFLAGSLIB  = /DCURL_STATICLIB
 LNKDLL     = link.exe /DLL
 LNKLIB     = link.exe /lib
@@ -100,7 +100,8 @@
 SSLLIBS    = libeay32.lib ssleay32.lib
 ZLIBLIBSDLL= zdll.lib
 ZLIBLIBS   = zlib.lib
-WINLIBS    = ws2_32.lib bufferoverflowu.lib wldap32.lib
+ZLIBLIBSDBG= zlibd.lib
+WINLIBS    = areslib.lib ws2_32.lib bufferoverflowu.lib wldap32.lib
 CFLAGS     = $(CFLAGS)
 
 CFGSET     = FALSE
@@ -292,7 +293,7 @@
 TARGET   = $(LIB_NAME_DEBUG).lib
 DIROBJ   = $(CFG)
 LFLAGSZLIB = "/LIBPATH:$(ZLIB_PATH)"
-LNK      = $(LNKLIB) $(ZLIBLIBS) $(LFLAGSZLIB) /out:$(DIROBJ)\$(TARGET)
+LNK      = $(LNKLIB) $(ZLIBLIBSDBG) $(LFLAGSZLIB) /out:$(DIROBJ)\$(TARGET)
 CC       = $(CCDEBUG) $(RTLIBD) $(CFLAGSZLIB) $(CFLAGSLIB)
 CFGSET   = TRUE
 !ENDIF
@@ -317,7 +318,7 @@
 DIROBJ   = $(CFG)
 LFLAGSZLIB = "/LIBPATH:$(ZLIB_PATH)"
 LFLAGSSSL = "/LIBPATH:$(OPENSSL_PATH)\out32"
-LNK      = $(LNKLIB) $(ZLIBLIBS) $(LFLAGSSSL) $(LFLAGSZLIB) /out:$(DIROBJ)\$(TARGET)
+LNK      = $(LNKLIB) $(ZLIBLIBSDBG) $(LFLAGSSSL) $(LFLAGSZLIB) /out:$(DIROBJ)\$(TARGET)
 CC       = $(CCDEBUG) $(RTLIBD) $(CFLAGSSSL) $(CFLAGSZLIB) $(CFLAGSLIB)
 CFGSET   = TRUE
 !ENDIF
diff -b -u -r curl-7.21.1-orig/lib/Makefile.vc9 curl-7.21.1/lib/Makefile.vc9
--- curl-7.21.1-orig/lib/Makefile.vc9	2010-08-11 17:36:29.000000000 -0400
+++ curl-7.21.1/lib/Makefile.vc9	2010-11-19 16:33:25.741750000 -0500
@@ -100,6 +100,7 @@
 SSLLIBS    = libeay32.lib ssleay32.lib
 ZLIBLIBSDLL= zdll.lib
 ZLIBLIBS   = zlib.lib
+ZLIBLIBSDBG= zlibd.lib
 WINLIBS    = ws2_32.lib wldap32.lib
 CFLAGS     = $(CFLAGS)
 
@@ -292,7 +293,7 @@
 TARGET   = $(LIB_NAME_DEBUG).lib
 DIROBJ   = $(CFG)
 LFLAGSZLIB = "/LIBPATH:$(ZLIB_PATH)"
-LNK      = $(LNKLIB) $(ZLIBLIBS) $(LFLAGSZLIB) /out:$(DIROBJ)\$(TARGET)
+LNK      = $(LNKLIB) $(ZLIBLIBSDBG) $(LFLAGSZLIB) /out:$(DIROBJ)\$(TARGET)
 CC       = $(CCDEBUG) $(RTLIBD) $(CFLAGSZLIB) $(CFLAGSLIB)
 CFGSET   = TRUE
 !ENDIF
@@ -317,7 +318,7 @@
 DIROBJ   = $(CFG)
 LFLAGSZLIB = "/LIBPATH:$(ZLIB_PATH)"
 LFLAGSSSL = "/LIBPATH:$(OPENSSL_PATH)\out32"
-LNK      = $(LNKLIB) $(ZLIBLIBS) $(LFLAGSSSL) $(LFLAGSZLIB) /out:$(DIROBJ)\$(TARGET)
+LNK      = $(LNKLIB) $(ZLIBLIBSDBG) $(LFLAGSSSL) $(LFLAGSZLIB) /out:$(DIROBJ)\$(TARGET)
 CC       = $(CCDEBUG) $(RTLIBD) $(CFLAGSSSL) $(CFLAGSZLIB) $(CFLAGSLIB)
 CFGSET   = TRUE
 !ENDIF
diff -b -u -r curl-7.21.1-orig/lib/config-win32.h curl-7.21.1/lib/config-win32.h
--- curl-7.21.1-orig/lib/config-win32.h	2010-08-02 12:53:33.000000000 -0400
+++ curl-7.21.1/lib/config-win32.h	2010-11-19 16:35:17.085500000 -0500
@@ -525,10 +525,10 @@
  */
 
 /* Define USE_ARES to enable c-ares asynchronous DNS lookups */
-/* #define USE_ARES 1 */
+#define USE_ARES 1
 
 /* Define USE_THREADS_WIN32 to enable threaded asynchronous DNS lookups */
-#define USE_THREADS_WIN32 1
+/* #define USE_THREADS_WIN32 1 */
 
 #if defined(USE_ARES) && defined(USE_THREADS_WIN32)
 #  error "Only one DNS lookup specialty may be defined at most"
